## Illustrations chapter one

library(tidyverse)
library(rvest)

## Google ngrams
## https://books.google.com/ngrams/graph?content=data+science&year_start=1920&year_end=2008&corpus=15&smoothing=3&share=&direct_url=t1%3B%2Cdata%20science%3B%2Cc0

ngram <- tibble(Year = seq(1920, 2008, 1),
                ngrams = c(1.7154604126101702e-10, 1.3723683300881362e-10, 1.1436402750734469e-10, 9.802630929200973e-11, 1.1201634064761379e-10, 1.1201634064761379e-10, 1.1201634064761379e-10, 1.1201634064761379e-10, 4.5713992115535365e-10, 4.5713992115535365e-10, 4.5713992115535365e-10, 3.4512358050773987e-10, 4.6283479429983943e-10, 4.6283479429983943e-10, 4.6283479429983943e-10, 1.177112137920996e-10, 1.177112137920996e-10, 1.177112137920996e-10, 1.177112137920996e-10, 0.0, 3.058757691576375e-10, 3.058757691576375e-10, 3.058757691576375e-10, 3.058757691576375e-10, 3.058757691576375e-10, 3.058757691576375e-10, 3.889260818163669e-10, 8.305031265872945e-11, 8.305031265872945e-11, 8.305031265872945e-11, 8.305031265872945e-11, 8.305031265872945e-11, 8.305031265872945e-11, 0.0, 1.395712434515417e-10, 4.153182876974272e-10, 4.153182876974272e-10, 4.153182876974272e-10, 5.214671075900615e-10, 5.214671075900615e-10, 5.675999194463901e-10, 4.280286759948483e-10, 1.9359918033780487e-10, 1.9359918033780487e-10, 3.054578296650996e-10, 2.336834931908933e-10, 2.6827680156747494e-10, 2.2214398971114642e-10, 2.2214398971114642e-10, 2.4614727319896955e-10, 3.133204370556594e-10, 4.709157706640963e-10, 4.697368962057271e-10, 4.67245500227317e-10, 5.303706362980165e-10, 5.615546083692635e-10, 5.864101188762e-10, 5.487470834873522e-10, 3.6748839289073894e-10, 3.342927839306802e-10, 4.659575542869427e-10, 5.052963523789953e-10, 6.479463434048784e-10, 6.751130012170949e-10, 6.456028727492529e-10, 6.232939561304615e-10, 6.232939561304615e-10, 5.748362976097456e-10, 5.70952380612206e-10, 5.761254647954469e-10, 4.950853219451038e-10, 6.644803279038619e-10, 6.807547462247701e-10, 7.429683019604433e-10, 6.882306986215931e-10, 1.110237873858111e-09, 9.720483188210442e-10, 1.263845040526996e-09, 1.1783114523782651e-09, 1.1612850324217915e-09, 1.1090438250300443e-09, 1.085456450912657e-09, 6.874141850981325e-10, 8.421127882320332e-10, 6.399990259975397e-10, 5.980627580472384e-10, 6.217497812895564e-10, 7.321384498659711e-10, 8.50450980471873e-10))

ngram$Date <- as.POSIXct(paste(ngram$Year, 1, 1, sep = "-"))
ngram$ngrams <- ngram$ngrams / max(ngram$ngrams)

## Google Trends
trends <- read_csv("GoogleTrends_DataScience.csv", skip = 2)
names(trends) <- c("Year_Month", "Searches")
trends$Year <- substr(trends$Year_Month, 1, 4)
trends$Month <- substr(trends$Year_Month, 6, 7)
trends$Searches <- trends$Searches / 100
trends$Date <- as.POSIXct(paste(trends$Year, trends$Month, 1, sep = "-"))

## Visualisation
google <- full_join(ngram, trends, by = "Date") %>%
    select(Date, ngrams, Searches) %>%
    gather(Source, Value, -Date) %>%
    mutate(Date = as.Date(Date))

ggplot(google, aes(Date, Value, col = Source)) +
    geom_line(col = "#1b7ea7", size = 1) +
    scale_y_continuous(labels = scales::percent) + 
    xlim(as.Date("1960-01-01"), as.Date("2018-12-31"))  +
    ylab("Relative Occurence") + xlab("Year") + 
    facet_grid(Source~.) +
    theme_minimal(base_size = 20)

ggsave("../manuscript/images/figure02_Data_Science_Trends.png",
       dpi = 300, width = 8, height = 6)
